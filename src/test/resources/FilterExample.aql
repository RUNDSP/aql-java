connect '127.0.0.1' 3000


drop module flight-package.lua
REGISTER module 'src/test/resources/flight-package.lua'
show modules
DROP INDEX test.flights flight_date
DROP INDEX test.flights flight_day
DROP INDEX test.flights flight_dep_time
CREATE INDEX flight_date ON test.flights (FL_DATE) STRING
CREATE INDEX flight_day ON test.flights (DAY_OF_MONTH) NUMERIC
CREATE INDEX flight_dep_time ON test.flights (DEP_TIME) NUMERIC
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('3',	2012,	1,	'2012-11-11',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	855, 1142, 347, 330, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('4',	2012,	2,	'2012-01-02',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	921, 1210, 349, 325, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('5',	2012,	3,	'2012-01-03',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	931, 1224, 353, 319, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('6',	2012,	4,	'2012-01-04',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	904, 1151, 347, 309, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('7',	2012,	5,	'2012-01-05',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	858, 1142, 344, 306, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('8',	2012,	6,	'2012-01-06',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	911, 1151, 340, 321, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('9',	2012,	7,	'2012-01-07',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	902, 1203, 361, 337, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('10',	2012,	8,	'2012-01-08',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	855, 1129, 334, 318, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('11',	2012,	9,	'2012-01-09',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	858, 1127, 329, 307, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('12',	2012,	10,	'2012-01-10',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	852, 1134, 342, 325, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('13',	2012,	11,	'2012-01-11',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	853, 1152, 359, 322, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('14',	2012,	12,	'2012-01-12',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	902, 1208, 366, 322, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('15',	2012,	13,	'2012-01-13',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	853, 1133, 340, 313, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('16',	2012,	14,	'2012-01-14',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	902, 1149, 347, 324, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('17',	2012,	15,	'2012-01-15',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	902, 1218, 376, 339, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('18',	2012,	16,	'2012-01-16',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	854, 1208, 374, 350, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('19',	2012,	17,	'2012-01-17',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	854, 1226, 392, 350, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('20',	2012,	18,	'2012-01-18',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	900, 1154, 354, 328, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('21',	2012,	19,	'2012-01-19',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	855, 1157, 362, 333, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('22',	2012,	20,	'2012-01-20',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	858, 1227, 389, 353, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('23',	2012,	21,	'2012-01-21',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	913, 1318, 425, 358, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('24',	2012,	22,	'2012-01-22',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	853, 1159, 366, 336, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('25',	2012,	23,	'2012-01-23',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	853, 1209, 376, 345, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('26',	2012,	24,	'2012-01-24',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	850, 1144, 354, 320, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('27',	2012,	25,	'2012-01-25',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	856, 1145, 349, 329, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('28',	2012,	26,	'2012-01-26',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	854, 1216, 382, 338, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('29',	2012,	27,	'2012-01-27',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	926, 1238, 372, 331, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('30',	2012,	28,	'2012-01-28',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	851, 1154, 363, 329, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('31',	2012,	29,	'2012-01-29',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	853, 1143, 350, 335, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('32',	2012,	30,	'2012-01-30',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	854, 1203, 369, 340, 2475)
INSERT INTO test.flights (PK, YEAR, DAY_OF_MONTH, FL_DATE, AIRLINE_ID, CARRIER, FL_NUM, ORI_AIRPORT_ID, ORIGIN, ORI_CITY_NAME, ORI_STATE_ABR, DEST, DEST_CITY_NAME, DEST_STATE_ABR, DEP_TIME, ARR_TIME, ELAPSED_TIME, AIR_TIME, DISTANCE) VALUES ('33',	2012,	31,	'2012-01-31',	19805,	'AA',	1, 12478, 	'JFK',	'New York', 'NY', 'LAX', 'Los Angeles',	 'CA',	852, 1153, 361, 330, 2475)

show indexes

print 'Query on day of month'
select * from test.flights where DAY_OF_MONTH between 7 and 14
print 'Query on flight date'
select * from test.flights where FL_DATE = '2012-01-31'

print 'Aggregate with filter'
AGGREGATE flight-package.time(0, 2300) ON test.flights WHERE FL_DATE = '2012-01-31'
